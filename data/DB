/*
  CREATE DATABASE enote;

  CREATE USER 'enote_user'@'localhost' IDENTIFIED BY 'admin';
  GRANT ALL PRIVILEGES ON enote TO 'enote_user'@'localhost';
*/

CREATE TABLE IF NOT EXISTS `user` (
  `id` int AUTO_INCREMENT,
  `email` varchar(255) NOT NULL,
  `password` varchar(255) NOT NULL,
  `name` varchar(255) NOT NULL,
  `surname` varchar(255) NOT NULL,
  `registration_date` date NOT NULL DEFAULT NOW(),

  PRIMARY KEY (`id`),
  UNIQUE (`email`, `password`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_bin;

CREATE TABLE IF NOT EXISTS `note` (
  `id` int AUTO_INCREMENT,
  `user` int NOT NULL,
  `text` varchar(255) NOT NULL,
  `attachment` int,

  PRIMARY KEY (`id`),
  FOREIGN KEY( `user` ) REFERENCES user( `id` )
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_bin;

CREATE TABLE IF NOT EXISTS `attachment` (
  `id` int AUTO_INCREMENT,
  `type` varchar(255) NOT NULL,

  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_bin;



CREATE TABLE IF NOT EXISTS `note_label` (
  `id` int AUTO_INCREMENT,
  `note` int NOT NULL,
  `label` int NOT NULL,

  PRIMARY KEY (`id`),
  FOREIGN KEY( `note` ) REFERENCES note( `id` ),
  FOREIGN KEY( `label` ) REFERENCES label( `id` )
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_bin;

CREATE TABLE IF NOT EXISTS `note_notebook` (
  `id` int AUTO_INCREMENT,
  `note` int NOT NULL,
  `notebook` int NOT NULL,

  PRIMARY KEY (`id`),
  FOREIGN KEY( `note` ) REFERENCES note( `id` ),
  FOREIGN KEY( `notebook` ) REFERENCES notebook( `id` )
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_bin;

